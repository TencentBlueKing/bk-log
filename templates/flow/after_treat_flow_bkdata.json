[
    {
        "result_table_id":"{{after_treat.sample_set_stream_source.result_table_id}}",
        "bk_biz_id":{{after_treat.bk_biz_id }},
        "name":"参与聚类日志",
        "id":268068,
        "from_nodes":[

        ],
        "node_type":"stream_source",
        "frontend_info":{
            "x":30,
            "y":153
        }
    },
    {
        "result_table_id":"{{after_treat.non_clustering_stream_source.result_table_id}}",
        "bk_biz_id":{{after_treat.bk_biz_id }},
        "name":"不参与聚类日志",
        "id":268070,
        "from_nodes":[

        ],
        "node_type":"stream_source",
        "frontend_info":{
            "x":1000,
            "y":-160
        }
    },
    {
        "bk_biz_id":{{after_treat.bk_biz_id}},
        "table_name":"{{after_treat.model.table_name}}",
        "output_name":"模型输出",
        "name":"聚类模型应用",
        "model_release_id":{{after_treat.model.model_release_id}},
        "input_config":{
             "input_node":{
                "fields": {{after_treat.model.input_fields}},
                "sample_set_table_desc":null,
                "sample_set_table_name":"sample_table",
                "group_serving_enable":true,
                "input_result_table":"{{after_treat.sample_set_stream_source.result_table_id}}",
                "group_serving":false,
                "group_columns":[],
                "add_on_input":[],
                "grouped_training":false,
                "input_columns_changeable":{
                    "condition":"lt",
                    "condition_value":"500",
                    "value":true
                }
            }
        },
        "output_config":{
            "output_node":{
                "table_name":"{{after_treat.model.table_name}}",
                "table_alias":"模型输出",
                "fields": {{after_treat.model.output_fields}},
                "table_zh_name":"模型输出"
            }
        },
        "schedule_config":{
            "serving_scheduler_params":{
                "dependency_rule":"all_finished",
                "period":1,
                "period_unit":"day",
                "fixed_delay":0,
                "first_run_time":"",
                "data_period":1,
                "data_period_unit":"day",
                "recovery":{
                    "enable":false,
                    "interval_time":"5m",
                    "retry_times":1
                }
            },
            "training_scheduler_params":null
        },
        "serving_mode":"realtime",
        "sample_feedback_config":{
            "result_table_feedback":false
        },
        "upgrade_config":{
            "notification":false,
            "auto_upgrade":true,
            "specific_update_config":{
                "specific_update":false,
                "update_time":"12:00"
            }
        },
        "model_id":"{{after_treat.model.model_id}}",
        "model_extra_config":{
            "predict_args":[

            ]
        },
        "scene_name":"custom",
        "id":268071,
        "from_nodes":[
            {
                "id":268068,
                "from_result_table_ids":[
                    "{{after_treat.sample_set_stream_source.result_table_id}}"
                ]
            }
        ],
        "node_type":"model_ts_custom",
        "frontend_info":{
            "x":355,
            "y":171
        }
    },
    {
        "bk_biz_id":{{after_treat.bk_biz_id }},
        "sql":"select {{after_treat.change_field.fields}} from {{after_treat.model.result_table_id}}, lateral table(udf_signature_format(log_signature)) as T(dist_01, dist_03, dist_05, dist_07, dist_09)",
        "table_name":"{{after_treat.change_field.table_name}}",
        "name":"字段转换处理",
        "count_freq":null,
        "waiting_time":null,
        "window_time":null,
        "window_type":"none",
        "counter":null,
        "output_name":"字段转换处理",
        "session_gap":null,
        "expired_time":null,
        "window_lateness":{
            "allowed_lateness":false,
            "lateness_time":1,
            "lateness_count_freq":60
        },
        "correct_config_id":null,
        "is_open_correct":false,
        "id":268073,
        "from_nodes":[
            {
                "id":268071,
                "from_result_table_ids":[
                    "{{after_treat.model.result_table_id}}"
                ]
            }
        ],
        "node_type":"realtime",
        "frontend_info":{
            "x":1005,
            "y":51
        }
    },
    {
        "bk_biz_id":{{after_treat.bk_biz_id }},
        "name":"合并日志",
        "table_name":"{{after_treat.merge_table.table_name}}",
        "output_name":"合并日志",
        "description":"合并日志",
        "config":[

        ],
        "id":268075,
        "from_nodes":[
            {
                "id":268073,
                "from_result_table_ids":[
                    "{{after_treat.bk_biz_id}}_{{after_treat.change_field.table_name}}"
                ]
            },
            {
                "id":268070,
                "from_result_table_ids":[
                    "{{after_treat.non_clustering_stream_source.result_table_id}}"
                ]
            }
        ],
        "node_type":"merge",
        "frontend_info":{
            "x":1330,
            "y":51
        }
    },
    {
        "bk_biz_id":{{after_treat.bk_biz_id}},
        "sql":"select {{after_treat.change_clustering_field.fields}} from {{ after_treat.merge_table.result_table_id}}",
        "table_name":"{{ after_treat.change_clustering_field.table_name }}",
        "name":"改变聚类字段",
        "count_freq":null,
        "waiting_time":null,
        "window_time":null,
        "window_type":"none",
        "counter":null,
        "output_name":"改变聚类字段",
        "session_gap":null,
        "expired_time":null,
        "window_lateness":{
            "allowed_lateness":false,
            "lateness_time":1,
            "lateness_count_freq":60
        },
        "correct_config_id":null,
        "is_open_correct":false,
        "id":289247,
        "from_nodes":[
            {
                "id":268075,
                "from_result_table_ids":[
                    "{{after_treat.merge_table.result_table_id}}"
                ]
            }
        ],
        "node_type":"realtime",
        "frontend_info":{
            "x":1002,
            "y":166
        }
    },
    {
        "result_table_id":"{{after_treat.change_clustering_field.result_table_id}}",
        "name":"合并日志(elastic_storage)",
        "bk_biz_id":{{after_treat.bk_biz_id}},
        "cluster":"{{after_treat.es_cluster}}",
        "analyzed_fields":{{after_treat.es.analyzed_fields}},
        "date_fields":[],
        "doc_values_fields":{{after_treat.es.doc_values_fields}},
        "json_fields":{{after_treat.es.json_fields}},
        "expires":{{after_treat.es.expires}},
        "has_replica":{{after_treat.es.has_replica}},
        "has_unique_key":false,
        "storage_keys":[

        ],
        "id":289248,
        "from_nodes":[
            {
                "id":289247,
                "from_result_table_ids":[
                    "{{after_treat.change_clustering_field.result_table_id}}"
                ]
            }
        ],
        "node_type":"elastic_storage",
        "frontend_info":{
            "x":1217,
            "y":270
        }
    },
    {
        "bk_biz_id":{{after_treat.bk_biz_id}},
        "sql":"select event_time, sensitivity ,signature from {{after_treat.model.result_table_id}}, lateral table(udf_deal_model_json(log_signature)) as T(sensitivity,signature)",
        "table_name":"{{after_treat.format_signature.table_name}}",
        "name":"将signature打平成为一个字段",
        "count_freq":null,
        "waiting_time":null,
        "window_time":null,
        "window_type":"none",
        "counter":null,
        "output_name":"将signature打平成为一个字段",
        "session_gap":null,
        "expired_time":null,
        "window_lateness":{
            "allowed_lateness":false,
            "lateness_time":1,
            "lateness_count_freq":60
        },
        "correct_config_id":null,
        "is_open_correct":false,
        "id":268093,
        "from_nodes":[
            {
                "id":268071,
                "from_result_table_ids":[
                    "{{after_treat.model.result_table_id}}"
                ]
            }
        ],
        "node_type":"realtime",
        "frontend_info":{
            "x":680,
            "y":204
        }
    },
    {
        "bk_biz_id":{{after_treat.bk_biz_id}},
        "sql":"select event_time, signature, history_time, sensitivity from {{after_treat.join_signature.result_table_id}}",
        "table_name":"{{after_treat.join_signature_tmp.table_name}}",
        "name":"join signature tmp",
        "count_freq":null,
        "waiting_time":null,
        "window_time":null,
        "window_type":"none",
        "counter":null,
        "output_name":"join signature tmp",
        "session_gap":null,
        "expired_time":null,
        "window_lateness":{
            "allowed_lateness":false,
            "lateness_time":1,
            "lateness_count_freq":60
        },
        "correct_config_id":null,
        "is_open_correct":false,
        "id":268098,
        "from_nodes":[
            {
                "id":268110,
                "from_result_table_ids":[
                    "{{after_treat.join_signature.result_table_id}}"
                ]
            }
        ],
        "node_type":"realtime",
        "frontend_info":{
            "x":1655,
            "y":222
        }
    },
    {
        "bk_biz_id":{{after_treat.bk_biz_id}},
        "sql":"select event_time, signature, history_time, sensitivity from {{after_treat.join_signature_tmp.result_table_id}} where (event_time = history_time or event_time - history_time > 86400000) {{after_treat.judge_new_class.filter_rule}}",
        "table_name":"{{after_treat.judge_new_class.table_name}}",
        "name":"新类判断",
        "count_freq":null,
        "waiting_time":null,
        "window_time":null,
        "window_type":"none",
        "counter":null,
        "output_name":"新类判断",
        "session_gap":null,
        "expired_time":null,
        "window_lateness":{
            "allowed_lateness":false,
            "lateness_time":1,
            "lateness_count_freq":60
        },
        "correct_config_id":null,
        "is_open_correct":false,
        "id":268099,
        "from_nodes":[
            {
                "id":268098,
                "from_result_table_ids":[
                    "{{after_treat.join_signature_tmp.result_table_id}}"
                ]
            }
        ],
        "node_type":"realtime",
        "frontend_info":{
            "x":1980,
            "y":153
        }
    },
    {
        "bk_biz_id":{{after_treat.bk_biz_id}},
        "sql":"select a.event_time, a.event_time as history_time, a.signature, a.sensitivity from {{after_treat.group_by.result_table_id}} a",
        "table_name":"{{after_treat.join_signature.table_name}}",
        "name":"format_signature",
        "count_freq":null,
        "waiting_time":null,
        "window_time":null,
        "window_type":"none",
        "counter":null,
        "output_name":"format_signature",
        "session_gap":null,
        "expired_time":null,
        "window_lateness":{
            "allowed_lateness":false,
            "lateness_time":1,
            "lateness_count_freq":60
        },
        "correct_config_id":null,
        "is_open_correct":false,
        "id":268110,
        "from_nodes":[
            {
                "id":268189,
                "from_result_table_ids":[
                    "{{after_treat.group_by.result_table_id}}"
                ]
            }
        ],
        "node_type":"realtime",
        "frontend_info":{
            "x":1330,
            "y":204
        }
    },
    {
        "bk_biz_id":{{after_treat.bk_biz_id}},
        "sql":"select max(event_time) as event_time, sensitivity, signature from {{after_treat.format_signature.result_table_id}} GROUP BY sensitivity, signature",
        "table_name":"{{after_treat.group_by.table_name}}",
        "name":"预聚合节点",
        "count_freq":300,
        "waiting_time":0,
        "window_time":null,
        "window_type":"scroll",
        "counter":null,
        "output_name":"预聚合节点",
        "session_gap":null,
        "expired_time":null,
        "window_lateness":{
            "allowed_lateness":false,
            "lateness_time":1,
            "lateness_count_freq":60
        },
        "correct_config_id":null,
        "is_open_correct":false,
        "id":268189,
        "from_nodes":[
            {
                "id":268093,
                "from_result_table_ids":[
                    "{{after_treat.format_signature.result_table_id}}"
                ]
            }
        ],
        "node_type":"realtime",
        "frontend_info":{
            "x":1005,
            "y":204
        }
    },
    {
        "name":"join signature缓存(redis)",
        "bk_biz_id":{{after_treat.bk_biz_id}},
        "cluster":"{{after_treat.redis.cluster}}",
        "expires":-1,
        "expires_unit":"",
        "result_table_id":"{{after_treat.join_signature_tmp.result_table_id}}",
        "from_nodes":[
            {
                "id":268098,
                "from_result_table_ids":[
                    "{{after_treat.join_signature_tmp.result_table_id}}"
                ]
            }
        ],
        "separator":":",
        "key_separator":"_",
        "storage_type":"join",
        "keys":[
            "sensitivity",
            "signature"
        ],
        "id":268244,
        "node_type":"redis_storage",
        "frontend_info":{
            "x":1941,
            "y":320
        }
    },
    {
        "bk_biz_id": {{after_treat.bk_biz_id}},
        "name": "业务数据回流",
        "table_name": "{{after_treat.diversion.table_name}}",
        "output_name": "回流数据",
        "description": "回流数据",
        "config": [
            {
                "bk_biz_id": {{after_treat.target_bk_biz_id}},
                "logic_exp": "true"
            }
        ],
        "id": 283083,
        "from_nodes": [
            {
                "id": 268099,
                "from_result_table_ids": [
                    "{{after_treat.judge_new_class.result_table_id}}"
                ]
            }
        ],
        "node_type": "split",
        "frontend_info": {
            "x": 2438.4636054742855,
            "y": 181.10343771074696
        }
    }
]